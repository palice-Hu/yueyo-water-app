# 水印文件本地应用 PRD

## 1. 项目概述

本项目旨在开发一款基于 Python 的 Windows 桌面应用程序，用于给图片添加水印。该应用支持文本水印和图片水印功能，提供直观的用户界面和实时预览功能。

## 2. 技术栈

- **主要语言**: Python 3.8+
- **GUI框架**: PyQt5 或 tkinter
- **图像处理**: Pillow (PIL)
- **系统接口**: os, sys
- **配置管理**: json
- **打包工具**: PyInstaller

## 3. 功能需求

### 3.1 文件处理模块

#### 3.1.1 图片导入
- 支持单张图片拖拽导入
- 支持文件选择器导入单张图片
- 支持批量导入多张图片
- 支持文件夹导入功能
- 界面显示图片列表（含缩略图和文件名）

#### 3.1.2 格式支持
- 输入格式：JPEG, PNG (必需)；BMP, TIFF (建议)
- PNG格式需支持透明通道
- 输出格式：JPEG, PNG 可选

#### 3.1.3 图片导出
- 用户可指定输出文件夹
- 默认禁止导出到原文件夹以防止覆盖
- 导出命名规则选项：
  - 保留原文件名
  - 添加自定义前缀（如 wm_）
  - 添加自定义后缀（如 _watermarked）
- JPEG 格式质量调节滑块（0-100）
- 图片尺寸调整功能（宽度、高度或百分比缩放）

### 3.2 水印类型

#### 3.2.1 文本水印
- 自定义文本内容输入
- 字体选择（系统已安装字体）
- 字号、粗体、斜体设置
- 字体颜色调色板
- 文本透明度调节（0-100%）
- 阴影或描边效果增强可读性

#### 3.2.2 图片水印
- 支持本地图片（如Logo）作为水印
- 支持带透明通道的PNG图片
- 图片水印缩放功能
- 图片水印透明度调节（0-100%）

### 3.3 水印布局与样式

#### 3.3.1 实时预览
- 所有水印调整实时显示效果
- 支持在图片列表中切换预览不同图片

#### 3.3.2 位置控制
- 九宫格预设位置（四角、正中心）
- 鼠标拖拽手动定位

#### 3.3.3 旋转功能
- 滑块或输入框调节水印角度
- 支持任意角度旋转

### 3.4 配置管理

#### 3.4.1 水印模板
- 保存当前水印设置为模板（含内容、字体、颜色、位置、大小、透明度等）
- 模板加载、管理和删除功能
- 启动时自动加载上次设置或默认模板

## 4. 非功能需求

### 4.1 性能要求
- 支持常见尺寸图片的流畅处理
- 批量处理时保持界面响应

### 4.2 兼容性
- 兼容 Windows 10/11 操作系统
- 支持主流显示分辨率

### 4.3 用户体验
- 直观的图形用户界面
- 实时预览功能
- 操作反馈和错误提示

## 5. 项目依赖

```requirements
PyQt5>=5.15.0
Pillow>=8.0.0
```

## 6. 开发计划

### 6.1 第一阶段 - 核心功能开发
- 文件导入/导出功能
- 基本文本水印功能
- 基础界面设计

### 6.2 第二阶段 - 高级功能实现
- 图片水印功能
- 高级文本格式设置
- 实时预览功能

### 6.3 第三阶段 - 完善与优化
- 配置管理功能
- 界面美化与优化
- 测试与调试

## 7. 部署方案

使用 PyInstaller 将应用打包为独立的 Windows 可执行文件，便于分发和安装。